module.exports = {

"[project]/.next-internal/server/app/api/summarize/route/actions.js [app-rsc] (server actions loader, ecmascript)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
}}),
"[externals]/next/dist/compiled/next-server/app-route-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-route-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-route-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/@opentelemetry/api [external] (next/dist/compiled/@opentelemetry/api, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/@opentelemetry/api", () => require("next/dist/compiled/@opentelemetry/api"));

module.exports = mod;
}}),
"[externals]/next/dist/compiled/next-server/app-page-turbo.runtime.dev.js [external] (next/dist/compiled/next-server/app-page-turbo.runtime.dev.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js", () => require("next/dist/compiled/next-server/app-page-turbo.runtime.dev.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-unit-async-storage.external.js [external] (next/dist/server/app-render/work-unit-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-unit-async-storage.external.js", () => require("next/dist/server/app-render/work-unit-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/work-async-storage.external.js [external] (next/dist/server/app-render/work-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/work-async-storage.external.js", () => require("next/dist/server/app-render/work-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/next/dist/server/app-render/after-task-async-storage.external.js [external] (next/dist/server/app-render/after-task-async-storage.external.js, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("next/dist/server/app-render/after-task-async-storage.external.js", () => require("next/dist/server/app-render/after-task-async-storage.external.js"));

module.exports = mod;
}}),
"[externals]/util [external] (util, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("util", () => require("util"));

module.exports = mod;
}}),
"[externals]/stream [external] (stream, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("stream", () => require("stream"));

module.exports = mod;
}}),
"[externals]/path [external] (path, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("path", () => require("path"));

module.exports = mod;
}}),
"[externals]/http [external] (http, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("http", () => require("http"));

module.exports = mod;
}}),
"[externals]/https [external] (https, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("https", () => require("https"));

module.exports = mod;
}}),
"[externals]/url [external] (url, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("url", () => require("url"));

module.exports = mod;
}}),
"[externals]/fs [external] (fs, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("fs", () => require("fs"));

module.exports = mod;
}}),
"[externals]/crypto [external] (crypto, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("crypto", () => require("crypto"));

module.exports = mod;
}}),
"[externals]/assert [external] (assert, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("assert", () => require("assert"));

module.exports = mod;
}}),
"[externals]/tty [external] (tty, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("tty", () => require("tty"));

module.exports = mod;
}}),
"[externals]/os [external] (os, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("os", () => require("os"));

module.exports = mod;
}}),
"[externals]/zlib [external] (zlib, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("zlib", () => require("zlib"));

module.exports = mod;
}}),
"[externals]/events [external] (events, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("events", () => require("events"));

module.exports = mod;
}}),
"[externals]/node:stream [external] (node:stream, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:stream", () => require("node:stream"));

module.exports = mod;
}}),
"[externals]/buffer [external] (buffer, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("buffer", () => require("buffer"));

module.exports = mod;
}}),
"[externals]/string_decoder [external] (string_decoder, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("string_decoder", () => require("string_decoder"));

module.exports = mod;
}}),
"[externals]/node:assert [external] (node:assert, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:assert", () => require("node:assert"));

module.exports = mod;
}}),
"[externals]/node:net [external] (node:net, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:net", () => require("node:net"));

module.exports = mod;
}}),
"[externals]/node:http [external] (node:http, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:http", () => require("node:http"));

module.exports = mod;
}}),
"[externals]/node:buffer [external] (node:buffer, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:buffer", () => require("node:buffer"));

module.exports = mod;
}}),
"[externals]/node:querystring [external] (node:querystring, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:querystring", () => require("node:querystring"));

module.exports = mod;
}}),
"[externals]/node:events [external] (node:events, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:events", () => require("node:events"));

module.exports = mod;
}}),
"[externals]/node:diagnostics_channel [external] (node:diagnostics_channel, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:diagnostics_channel", () => require("node:diagnostics_channel"));

module.exports = mod;
}}),
"[externals]/node:util [external] (node:util, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:util", () => require("node:util"));

module.exports = mod;
}}),
"[externals]/node:tls [external] (node:tls, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:tls", () => require("node:tls"));

module.exports = mod;
}}),
"[externals]/node:zlib [external] (node:zlib, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:zlib", () => require("node:zlib"));

module.exports = mod;
}}),
"[externals]/node:perf_hooks [external] (node:perf_hooks, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:perf_hooks", () => require("node:perf_hooks"));

module.exports = mod;
}}),
"[externals]/node:util/types [external] (node:util/types, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:util/types", () => require("node:util/types"));

module.exports = mod;
}}),
"[externals]/node:worker_threads [external] (node:worker_threads, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:worker_threads", () => require("node:worker_threads"));

module.exports = mod;
}}),
"[externals]/node:crypto [external] (node:crypto, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:crypto", () => require("node:crypto"));

module.exports = mod;
}}),
"[externals]/node:http2 [external] (node:http2, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:http2", () => require("node:http2"));

module.exports = mod;
}}),
"[externals]/node:url [external] (node:url, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:url", () => require("node:url"));

module.exports = mod;
}}),
"[externals]/node:async_hooks [external] (node:async_hooks, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:async_hooks", () => require("node:async_hooks"));

module.exports = mod;
}}),
"[externals]/node:console [external] (node:console, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:console", () => require("node:console"));

module.exports = mod;
}}),
"[externals]/node:dns [external] (node:dns, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("node:dns", () => require("node:dns"));

module.exports = mod;
}}),
"[project]/src/lib/scraper.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
// src/lib/scraper.ts
__turbopack_context__.s({
    "scrapeTextFromURL": (()=>scrapeTextFromURL)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$axios$2f$lib$2f$axios$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/axios/lib/axios.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$cheerio$2f$dist$2f$esm$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$module__evaluation$3e$__ = __turbopack_context__.i("[project]/node_modules/cheerio/dist/esm/index.js [app-route] (ecmascript) <module evaluation>");
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$cheerio$2f$dist$2f$esm$2f$load$2d$parse$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/cheerio/dist/esm/load-parse.js [app-route] (ecmascript)");
;
;
async function scrapeTextFromURL(url) {
    // Pretend to be a real browser
    const response = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$axios$2f$lib$2f$axios$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].get(url, {
        headers: {
            // Modern browser UA string
            "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) " + "AppleWebKit/537.36 (KHTML, like Gecko) " + "Chrome/115.0.0.0 Safari/537.36",
            // Accept HTML only
            Accept: "text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8",
            // Some sites check Referer
            Referer: url
        },
        // Make sure we don’t reject non-2xx status codes immediately
        validateStatus: (status)=>status < 500
    });
    if (response.status === 403) {
        throw new Error("Medium is blocking our request (got 403).");
    }
    if (response.status !== 200) {
        throw new Error(`Unexpected status ${response.status}`);
    }
    const $ = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$cheerio$2f$dist$2f$esm$2f$load$2d$parse$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["load"])(response.data);
    // Pull text from <article> and <p>
    let text = "";
    $("article, p").each((_, el)=>{
        text += $(el).text().trim() + " ";
    });
    return text.trim();
}
}}),
"[project]/src/lib/summariser.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "summarizeText": (()=>summarizeText)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$axios$2f$lib$2f$axios$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/axios/lib/axios.js [app-route] (ecmascript)");
;
async function summarizeText(fullText, sentenceCount = 6) {
    try {
        // Try AI-based summarization first
        const { summary: aiSummary, title } = await generateAISummary(fullText, sentenceCount);
        return {
            summary: aiSummary,
            title
        };
    } catch (error) {
        console.error("AI summarization failed, falling back to extractive method:", error);
        // Fallback to extractive summarization if AI fails
        const extractiveSummary = extractiveSummarize(fullText, sentenceCount);
        const title = generateExtractiveTitle(fullText);
        return {
            summary: extractiveSummary,
            title
        };
    }
}
/**
 * Calls the Gemini API to generate an AI-powered summary and title
 */ async function generateAISummary(text, sentenceCount) {
    const apiKey = process.env.GEMINI_API_KEY;
    if (!apiKey) {
        throw new Error("GEMINI_API_KEY is not configured in environment variables");
    }
    // Try with a more stable model version
    const url = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent";
    try {
        // Add timeout and retry logic
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$axios$2f$lib$2f$axios$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].post(`${url}?key=${apiKey}`, {
            contents: [
                {
                    parts: [
                        {
                            text: `For the following text, provide: 
                1. A concise title (max 10 words)
                2. A summary in ${sentenceCount} sentences, keeping the most important information
                
                Format your response as:
                TITLE: [your title here]
                SUMMARY: [your summary here]
                
                Text to summarize:
                ${text}`
                        }
                    ]
                }
            ],
            generationConfig: {
                temperature: 0.2,
                maxOutputTokens: 800
            }
        }, {
            headers: {
                'Content-Type': 'application/json'
            },
            timeout: 10000 // 10 second timeout
        });
        // Extract the summary from the response
        const generatedText = response.data.candidates[0]?.content?.parts[0]?.text;
        if (!generatedText) {
            throw new Error("No summary was generated by the API");
        }
        // Parse title and summary from response
        const titleMatch = generatedText.match(/TITLE:\s*(.*?)(?:\n|$)/i);
        const summaryMatch = generatedText.match(/SUMMARY:\s*([\s\S]*?)(?:\n\n|$)/i);
        const title = titleMatch?.[1]?.trim() || generateExtractiveTitle(text);
        const summary = summaryMatch?.[1]?.trim() || generatedText.trim();
        return {
            summary,
            title
        };
    } catch (error) {
        console.error("Error calling Gemini API:", error);
        // If we get a 503 error, wait and retry once with a different model
        if (__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$axios$2f$lib$2f$axios$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].isAxiosError(error) && error.response?.status === 503) {
            try {
                console.log("Retrying after 503 error...");
                // Wait 2 seconds before retry
                await new Promise((resolve)=>setTimeout(resolve, 2000));
                // Try with a different model as fallback
                const fallbackUrl = "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent";
                const retryResponse = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$axios$2f$lib$2f$axios$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].post(`${fallbackUrl}?key=${apiKey}`, {
                    contents: [
                        {
                            parts: [
                                {
                                    text: `For the following text, provide: 
                    1. A concise title (max 10 words)
                    2. A summary in ${sentenceCount} sentences, keeping the most important information
                    
                    Format your response as:
                    TITLE: [your title here]
                    SUMMARY: [your summary here]
                    
                    Text to summarize:
                    ${text}`
                                }
                            ]
                        }
                    ],
                    generationConfig: {
                        temperature: 0.2,
                        maxOutputTokens: 800
                    }
                }, {
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    timeout: 15000 // Longer timeout for retry
                });
                const generatedText = retryResponse.data.candidates[0]?.content?.parts[0]?.text;
                if (!generatedText) {
                    throw new Error("No summary was generated by the API on retry");
                }
                // Parse title and summary from response
                const titleMatch = generatedText.match(/TITLE:\s*(.*?)(?:\n|$)/i);
                const summaryMatch = generatedText.match(/SUMMARY:\s*([\s\S]*?)(?:\n\n|$)/i);
                const title = titleMatch?.[1]?.trim() || generateExtractiveTitle(text);
                const summary = summaryMatch?.[1]?.trim() || generatedText.trim();
                return {
                    summary,
                    title
                };
            } catch (retryError) {
                console.error("Retry also failed:", retryError);
                throw retryError; // Propagate the error to trigger the fallback
            }
        }
        throw error;
    }
}
/**
 * Extractive summarization algorithm that selects important sentences
 * based on length, position, and keyword frequency.
 */ function extractiveSummarize(fullText, sentenceCount = 6) {
    // Clean and split the text into sentences
    const sentences = fullText.replace(/\n/g, " ").split(/(?<=[.?!])\s+/).filter((s)=>s.length > 20);
    if (sentences.length <= sentenceCount) {
        return sentences.join(" ");
    }
    // Calculate sentence scores based on position and length
    const scores = sentences.map((sentence, index)=>{
        // Position score - earlier sentences are often more important
        const positionScore = 1 - index / sentences.length;
        // Length score - favor medium-length sentences
        const lengthScore = Math.min(sentence.length / 100, 1);
        // Word count score - sentences with more words often contain more information
        const wordCount = sentence.split(/\s+/).length;
        const wordCountScore = Math.min(wordCount / 20, 1);
        // Combined score
        return {
            index,
            sentence,
            score: positionScore * 0.6 + lengthScore * 0.2 + wordCountScore * 0.2
        };
    });
    // Sort by score and take top sentences
    const topSentences = scores.sort((a, b)=>b.score - a.score).slice(0, sentenceCount).sort((a, b)=>a.index - b.index) // Restore original order
    .map((item)=>item.sentence);
    return topSentences.join(" ");
}
/**
 * Generates a simple title based on the first sentence or key phrases
 */ function generateExtractiveTitle(text) {
    // Get the first sentence
    const firstSentence = text.split(/[.!?]/, 1)[0].trim();
    // If it's short enough, use it as the title
    if (firstSentence.length <= 60) {
        return firstSentence;
    }
    // Otherwise, extract key words from the beginning
    const words = firstSentence.split(/\s+/).slice(0, 8);
    return words.join(' ') + '...';
}
}}),
"[project]/src/lib/translator.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "translateTitleToUrdu": (()=>translateTitleToUrdu),
    "translateToUrdu": (()=>translateToUrdu)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$axios$2f$lib$2f$axios$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/axios/lib/axios.js [app-route] (ecmascript)");
;
const dictionary = {
    "blog": "بلاگ",
    "summary": "خلاصہ",
    "text": "متن",
    "article": "مضمون",
    "sentence": "جملہ",
    "information": "معلومات",
    "title": "عنوان"
};
async function translateToUrdu(text) {
    try {
        // Try AI-based translation first
        return await generateAITranslation(text);
    } catch (error) {
        console.error("AI translation failed, falling back to dictionary method:", error);
        // Fallback to dictionary-based translation
        return dictionaryTranslate(text);
    }
}
async function translateTitleToUrdu(title) {
    try {
        // Try AI-based translation first
        return await generateAITranslation(title);
    } catch (error) {
        console.error("AI title translation failed, falling back to dictionary method:", error);
        // Fallback to dictionary-based translation
        return dictionaryTranslate(title);
    }
}
/**
 * Uses Gemini API to translate text to Urdu
 */ async function generateAITranslation(text) {
    const apiKey = process.env.GEMINI_API_KEY;
    if (!apiKey) {
        throw new Error("GEMINI_API_KEY is not configured in environment variables");
    }
    const url = "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.0-flash:generateContent";
    try {
        const response = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$axios$2f$lib$2f$axios$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].post(`${url}?key=${apiKey}`, {
            contents: [
                {
                    parts: [
                        {
                            text: `Translate the following English text to Urdu. Provide ONLY the Urdu translation without any explanations or notes:

${text}`
                        }
                    ]
                }
            ],
            generationConfig: {
                temperature: 0.2,
                maxOutputTokens: 1000
            }
        }, {
            headers: {
                'Content-Type': 'application/json'
            },
            timeout: 10000 // 10 second timeout
        });
        // Extract the translation from the response
        const translatedText = response.data.candidates[0]?.content?.parts[0]?.text;
        if (!translatedText) {
            throw new Error("No translation was generated by the API");
        }
        return translatedText.trim();
    } catch (error) {
        console.error("Error calling Gemini API for translation:", error);
        // If we get a 503 error, wait and retry once with a different model
        if (__TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$axios$2f$lib$2f$axios$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].isAxiosError(error) && error.response?.status === 503) {
            try {
                console.log("Retrying translation after 503 error...");
                // Wait 2 seconds before retry
                await new Promise((resolve)=>setTimeout(resolve, 2000));
                // Try with a different model as fallback
                const fallbackUrl = "https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-pro:generateContent";
                const retryResponse = await __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$axios$2f$lib$2f$axios$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["default"].post(`${fallbackUrl}?key=${apiKey}`, {
                    contents: [
                        {
                            parts: [
                                {
                                    text: `Translate the following English text to Urdu. Provide ONLY the Urdu translation without any explanations or notes:

${text}`
                                }
                            ]
                        }
                    ],
                    generationConfig: {
                        temperature: 0.2,
                        maxOutputTokens: 1000
                    }
                }, {
                    headers: {
                        'Content-Type': 'application/json'
                    },
                    timeout: 15000 // Longer timeout for retry
                });
                const translatedText = retryResponse.data.candidates[0]?.content?.parts[0]?.text;
                if (!translatedText) {
                    throw new Error("No translation was generated by the API on retry");
                }
                return translatedText.trim();
            } catch (retryError) {
                console.error("Translation retry also failed:", retryError);
                throw retryError;
            }
        }
        throw error;
    }
}
/**
 * Dictionary-based translation (fallback method)
 */ function dictionaryTranslate(text) {
    return text.split(/\b/).map((word)=>dictionary[word.toLowerCase()] || word).join("");
}
}}),
"[externals]/mongodb [external] (mongodb, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("mongodb", () => require("mongodb"));

module.exports = mod;
}}),
"[project]/src/lib/db/mongo.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "saveToMongo": (()=>saveToMongo)
});
var __TURBOPACK__imported__module__$5b$externals$5d2f$mongodb__$5b$external$5d$__$28$mongodb$2c$__cjs$29$__ = __turbopack_context__.i("[externals]/mongodb [external] (mongodb, cjs)");
;
const uri = process.env.MONGODB_URI;
let client = null;
const dbName = "blog_summariser";
async function saveToMongo(data) {
    try {
        // Create a new client if one doesn't exist
        if (!client) {
            client = new __TURBOPACK__imported__module__$5b$externals$5d2f$mongodb__$5b$external$5d$__$28$mongodb$2c$__cjs$29$__["MongoClient"](uri);
        }
        // Connect to the client
        await client.connect();
        const db = client.db(dbName);
        const collection = db.collection("full_texts");
        // Insert the document
        const result = await collection.insertOne({
            url: data.url,
            fullText: data.fullText,
            title: data.title,
            urduTitle: data.urduTitle,
            createdAt: new Date()
        });
        console.log("MongoDB save successful, document ID:", result.insertedId);
        return {
            success: true,
            id: result.insertedId
        };
    } catch (err) {
        console.error("MongoDB save error:", err);
        throw err;
    }
}
}}),
"[externals]/punycode [external] (punycode, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("punycode", () => require("punycode"));

module.exports = mod;
}}),
"[externals]/net [external] (net, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("net", () => require("net"));

module.exports = mod;
}}),
"[externals]/tls [external] (tls, cjs)": (function(__turbopack_context__) {

var { g: global, __dirname, m: module, e: exports } = __turbopack_context__;
{
const mod = __turbopack_context__.x("tls", () => require("tls"));

module.exports = mod;
}}),
"[project]/src/lib/db/supabase.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "findExistingSummary": (()=>findExistingSummary),
    "saveToSupabase": (()=>saveToSupabase)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__ = __turbopack_context__.i("[project]/node_modules/@supabase/supabase-js/dist/module/index.js [app-route] (ecmascript) <locals>");
;
// Create a single supabase client for interacting with your database
const supabase = (0, __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f40$supabase$2f$supabase$2d$js$2f$dist$2f$module$2f$index$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__$3c$locals$3e$__["createClient"])(("TURBOPACK compile-time value", "https://xzleyeqbfjuckefhatfb.supabase.co"), ("TURBOPACK compile-time value", "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Inh6bGV5ZXFiZmp1Y2tlZmhhdGZiIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTIxMzk5MjQsImV4cCI6MjA2NzcxNTkyNH0.VSn1cav9XexFx5e6ln4S9g88VQVgaJvFDeZgh_8Sl64"));
async function saveToSupabase(data) {
    try {
        // Enable RLS bypass for this operation
        const { error } = await supabase.from("summaries").insert([
            {
                url: data.url,
                summary: data.summary,
                translated: data.translated,
                title: data.title,
                urdu_title: data.urduTitle,
                created_at: new Date().toISOString()
            }
        ]).select();
        if (error) {
            console.error("Supabase error details:", error);
            throw new Error("Failed to save summary to Supabase: " + error.message);
        }
        return {
            success: true
        };
    } catch (err) {
        console.error("Supabase save error:", err);
        throw err;
    }
}
async function findExistingSummary(url) {
    try {
        const { data, error } = await supabase.from("summaries").select("summary, translated, title, urdu_title").eq("url", url).order("created_at", {
            ascending: false
        }).limit(1).single();
        if (error && error.code !== 'PGRST116') {
            console.error("Supabase query error:", error);
            throw new Error("Failed to query Supabase: " + error.message);
        }
        return data || null;
    } catch (err) {
        console.error("Supabase query error:", err);
        return null;
    }
}
}}),
"[project]/src/app/api/summarize/route.ts [app-route] (ecmascript)": ((__turbopack_context__) => {
"use strict";

var { g: global, __dirname } = __turbopack_context__;
{
__turbopack_context__.s({
    "POST": (()=>POST)
});
var __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/node_modules/next/server.js [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$scraper$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/scraper.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$summariser$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/summariser.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$translator$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/translator.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$db$2f$mongo$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/db/mongo.ts [app-route] (ecmascript)");
var __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$db$2f$supabase$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__ = __turbopack_context__.i("[project]/src/lib/db/supabase.ts [app-route] (ecmascript)");
;
;
;
;
;
;
async function POST(req) {
    try {
        const { url } = await req.json();
        if (!url) return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: "Missing URL"
        }, {
            status: 400
        });
        // Check if URL already exists in Supabase
        const existingSummary = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$db$2f$supabase$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["findExistingSummary"])(url);
        // If we found an existing summary, return it without reprocessing
        if (existingSummary) {
            console.log("Found existing summary for URL:", url);
            return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
                summary: existingSummary.summary,
                translated: existingSummary.translated,
                title: existingSummary.title,
                urduTitle: existingSummary.urdu_title,
                dbStatus: {
                    supabase: {
                        success: true,
                        cached: true
                    },
                    mongodb: {
                        success: true,
                        cached: true
                    }
                }
            });
        }
        // URL not found in database, proceed with scraping and processing
        console.log("Processing new URL:", url);
        const fullText = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$scraper$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["scrapeTextFromURL"])(url);
        const { summary, title } = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$summariser$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["summarizeText"])(fullText);
        // Get Urdu translation using AI
        const translated = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$translator$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["translateToUrdu"])(summary);
        const urduTitle = await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$translator$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["translateTitleToUrdu"])(title);
        // Database status tracking
        const dbStatus = {
            supabase: {
                success: false,
                error: null
            },
            mongodb: {
                success: false,
                error: null
            }
        };
        // Try Supabase
        try {
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$db$2f$supabase$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["saveToSupabase"])({
                url,
                summary,
                translated,
                title,
                urduTitle
            });
            dbStatus.supabase.success = true;
        } catch (error) {
            dbStatus.supabase.error = error instanceof Error ? error.message : String(error);
            console.error("Supabase error:", dbStatus.supabase.error);
        }
        // Try MongoDB
        try {
            await (0, __TURBOPACK__imported__module__$5b$project$5d2f$src$2f$lib$2f$db$2f$mongo$2e$ts__$5b$app$2d$route$5d$__$28$ecmascript$29$__["saveToMongo"])({
                url,
                fullText,
                title,
                urduTitle
            });
            dbStatus.mongodb.success = true;
        } catch (error) {
            dbStatus.mongodb.error = error instanceof Error ? error.message : String(error);
            console.error("MongoDB error:", dbStatus.mongodb.error);
        }
        // Return the summary along with database status
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            summary,
            translated,
            title,
            urduTitle,
            dbStatus
        });
    } catch (err) {
        console.error("API error:", err instanceof Error ? err.message : String(err));
        return __TURBOPACK__imported__module__$5b$project$5d2f$node_modules$2f$next$2f$server$2e$js__$5b$app$2d$route$5d$__$28$ecmascript$29$__["NextResponse"].json({
            error: err instanceof Error ? err.message : 'An unknown error occurred'
        }, {
            status: 500
        });
    }
}
}}),

};

//# sourceMappingURL=%5Broot-of-the-server%5D__a1a01f05._.js.map